Start

    Import json
    Import datetime

    FUNCTION intInput(inputMessage, errorMessage)
        WHILE no valid input is given DO
            Ask the user for a Input
            convert input to an integer
            IF input is not an integer
                PRINT error message
            ELSE
                RETURN the integer
            End IF
        END WHILE
    END FUNCTION

    FUNCTION floatInput(inputMessage, errorMessage)
        WHILE no valid input is given DO
            Ask the user for a Input
            convert input to a float
            IF input is not a float
                PRINT error message
            ELSE
                RETURN the integer
            End IF
        END WHILE
    END FUNCTION

    FUNCTION dateInput()
        While valid date Input not given DO
            Ask the user for a date Input
            TRY to parse input as date in 'yyyy-mm-dd' format
            IF input is not a valid date
                PRINT error message
            ELSE
                RETURN the date string
            END IF
        END WHILE
    END FUNCTION

    Function amountInput():
        Loop until valid input is received
            Call floatInput() function to prompt user for transaction amount
            Split the transaction amount to check for fractional part
            If amount is greater than 0 and fractional part has less than 3 digits
                Format amount to have exactly two decimal places
                Return formatted amount string
                Break out of loop
            Else
                print error message and continue Loop
    END FUNCTION

    FUNCTION loadTransactions()
        TRY to open 'transactions.json' file for reading
        IF file not found 
            PRINT error message and RETURN False
        ELSE IF error decoding JSON data
            PRINT error message and RETURN False
        END IF
        IF no transactions or error, 
            RETURN False
        ELSE 
            RETURN transactions
        END IF
        CLOSE file
    END FUNCTION

    FUNCTION saveTransactions(transactions)
        OPEN 'transactions.json' file for writing
        WRITE transactions data to file in JSON format
        CLOSE file
    END FUNCTION

    FUNCTION returnToMainMenu()
        WHILE valid input for choice is not given DO
            PRINT option for returning to main menu or exiting program
            PROMPT user for choice
            IF choice is to return to main menu
                PRINT main menu message 
                mainMenu()
            ELSE IF choice is to exit program, 
                PRINT exit message 
                EXIT program
            ELSE 
                PRINT error message and CONTINUE loop
        END WHILE
    END FUNCTION

    FUNCTION addTransaction()
        transactions = loadTransactions()
        IF no transactions
            INITIALIZE empty list called transactions
        End IF
        PROMPT user for transaction details (amount, category, type, date)
        VALIDATE input for amount, category, type, and date 
        CREATE new transaction sublist with input details
        APPEND the new transaction sublist to the transactions list
        SAVE updated transactions to file
        PRINT success message
    END FUNCTION

    FUNCTION viewTransactions(topic)
        transactions = loadTransactions() 
        IF no transactions
            PRINT error message and RETURN False
        ELSE
            PRINT topic
            PRINT table header
            LOOP through transactions 
                PRINT each transaction with its index +1 as ID
            END LOOP
            PRINT all transactions loaded
            RETURN transactions list
        END IF
    END FUNCTION

    FUNCTION updateConf(transactions, ID, ChangeID, value, message)
        WHILE no valid input is given DO
            PROMPT user for confirmation to update transaction
            IF yes
                UPDATE transaction with new value
                SAVE updated transactions to file
                PRINT success message
            ELSE 
                PRINT cancellation message
            END IF
        END While
    END FUNCTION

    FUNCTION updateTransaction()
        CALL viewTransactions() to display transactions
        PROMPT user for transaction ID to update
        IF ID is valid
            PRINT current transaction details
            LOOP the code for user to update data
                PROMPT user for which detail to update (amount, category, type, date)
                IF detail is amount:
                    PROMPT for new amount and UPDATE
                    updateConf()
                ELSE IF detail is category:
                    PROMPT for new category and UPDATE
                    updateConf()
                ELSE IF detail is type:
                    PROMPT for new type and UPDATE
                    updateConf()
                ELSE IF detail is date:
                    PROMPT for new date and UPDATE
                    updateConf()
                END IF
                PROMPT user for further updates or exit
                IF yes
                    CONTINUE the loop
                ELSE
                    END loop
        ELSE
            Ask for a valid ID
    END FUNCTION

    FUNCTION deleteTransaction()
        CALL viewTransactions() to display transactions
        WHILE
            PROMPT user for transaction ID to delete
            IF ID is valid
                PRINT current transaction details
                PROMPT user for confirmation to delete transaction
                IF yes:
                    DELETE transaction from list
                    SAVE updated transactions to file
                    PRINT success message
                ELSE 
                    PRINT cancellation message
                END IF
                END LOOP
            ELSE
                continue the LOOP
    END FUNCTION 

    FUNCTION printSummary(count, value)
        PRINT transaction count and total value
    END FUNCTION

    FUNCTION displaySummary()
        transactions = loadTransactions()
        IF no transactions
            PRINT error message
            returnToMainMenu()
        ELSE
            INITIALIZE variables for total income, total expenses, income count, and expenses count
            LOOP through transactions
                IF transaction type is income
                    ADD amount to total income and INCREMENT income count
                ELSE
                    ADD amount to total expenses and INCREMENT expenses count
                END IF
            END LOOP
            PRINT summary of income transactions using printSummary(count and total value)
            PRINT summary of expense transactions using printSummary(count and total value)
        END IF
    END FUNCTION

    FUNCTION menuChoice()
        LOOP UNTIL valid choice is made
            PRINT main menu options
            PROMPT user for choice
            IF choice is valid
                CALL corresponding function
                END LOOP
            ELSE
                PRINT error message and CONTINUE loop
            END IF
    END FUNCTION

    FUNCTION mainMenu()
        PRINT main menu options
        menuChoice()
    END FUNCTION

    IF script is executed directly
        mainMenu()
    END IF

END